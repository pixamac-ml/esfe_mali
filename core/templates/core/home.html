{% extends "base.html" %}
{% load static %}
{% block title %}Accueil — ESFé Mali{% endblock %}

{% block main_class %}pt-0{% endblock %}

{% block content %}
<style>
  .hero-full{min-height:100vh;height:100dvh;}
  @keyframes heroZoom{from{background-size:100%}to{background-size:108%}}
  .hero-zoom{animation:heroZoom 22s ease-in-out infinite alternate}

  @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(8px)}}
  .arrow-pulse{animation:floaty 2s ease-in-out infinite}

  #section-suivante{scroll-margin-top:80px}

  /* Typos premium */
  .font-display{font-family:"Poppins",sans-serif;}
  .font-body{font-family:"DM Sans",sans-serif;}
</style>

<section class="hero hero-full relative flex flex-col justify-center items-center text-center bg-cover bg-center hero-zoom"
         style="background-image:url({% static 'img/cover.jpg' %});">

  <!-- overlays -->
  <div class="absolute inset-0 bg-black/55"></div>
  <div class="absolute inset-0 bg-gradient-to-b from-transparent via-black/10 to-black/30"></div>

  <!-- LOGO -->
  <div class="absolute top-5 left-5 flex items-center gap-2 z-20">
    <img src="{% static 'img/logo-transparent.png' %}" alt="ESFé" class="h-8 sm:h-10 w-auto drop-shadow">
    <span class="font-display text-white font-bold text-base sm:text-lg">ESFé Mali</span>
  </div>

  <!-- CONTENU CENTRAL -->
  <div class="relative z-10 max-w-5xl mx-auto px-4 flex flex-col items-center">
    <h1 class="font-display text-white tracking-wide text-4xl sm:text-6xl md:text-7xl lg:text-8xl font-extrabold leading-tight mb-6">
      ESFé —
      <span id="annexe"
            class="inline-block text-brand-cyan text-2xl sm:text-3xl lg:text-4xl font-semibold align-middle ml-2">
      </span>
    </h1>

    <p class="font-body text-white/90 text-sm sm:text-base md:text-lg lg:text-xl leading-relaxed max-w-2xl mb-10 sm:mb-20 lg:mb-28">
      Création d’excellence en sciences de la santé —
      <span class="opacity-95">Enseignement, pratique et insertion.</span>
    </p>
  </div>

  <!-- BOUTONS EN BAS -->
  <div class="absolute bottom-10 flex flex-col sm:flex-row items-center gap-4 z-20">
    <a id="scroll-down" href="#section-suivante"
       class="h-12 w-12 grid place-items-center rounded-full border border-white/80 text-white hover:bg-white hover:text-primary-900 transition arrow-pulse"
       aria-label="Voir la suite">↓</a>

    <a href="{{ apply_url|default:'#admission' }}"
       class="px-6 py-3 rounded-full bg-brand-cyan text-primary-900 font-semibold hover:bg-white transition">
      S’inscrire
    </a>
  </div>
</section>

<div id="section-suivante"></div>

{% include "core/partials/_about_short.html" %}
{% include "core/partials/_formations.html" with featured_programs=featured_programs %}
{% include "core/partials/_stats.html" %}
{% include "core/partials/_admissions_cta.html" %}
{% include "core/partials/_blog_latest.html" %}
{% include "core/partials/_campuses.html" %}

<!-- GSAP pour animations fluides -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script>
  const annexes = ["Djélibougou","Moribabougou","Sikasso 1","Sikasso 2","San","Mopti","Ségou"];
  const el = document.getElementById('annexe');
  let i = 0;

  function showWord(word){
    return new Promise(resolve=>{
      gsap.fromTo(el,
        {opacity:0, y:40},
        {opacity:1, y:0, duration:1.2, ease:"power4.out", onStart:()=>{ el.textContent = word; },
         onComplete:()=>setTimeout(resolve,3000)});
    });
  }

  function hideWord(){
    return new Promise(resolve=>{
      gsap.to(el, {opacity:0, y:-40, duration:1, ease:"power4.in", onComplete:resolve});
    });
  }

  async function loop(){
    while(true){
      await showWord(annexes[i]);
      await hideWord();
      i = (i+1)%annexes.length;
    }
  }
  loop();

  // Scroll avec OFFSET
  document.getElementById('scroll-down')?.addEventListener('click', function(e){
    e.preventDefault();
    const section = document.getElementById('section-suivante');
    const navHeight = document.getElementById('mainNav')?.offsetHeight || 60;
    const offset = section.getBoundingClientRect().top + window.scrollY - navHeight - -80;
    window.scrollTo({ top: offset, behavior: 'smooth' });
  });
</script>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;900&family=DM+Sans:wght@400;500&display=swap" rel="stylesheet">

{% endblock %}
