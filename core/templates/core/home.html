{% extends "base.html" %}
{% load static %}
{% block title %}Accueil — ESFé Mali{% endblock %}
{% block content %}

<style>
  /* Zoom lent du background */
  @keyframes heroZoom { from { background-size:100%; } to { background-size:108%; } }
  .hero-zoom { animation: heroZoom 22s ease-in-out infinite alternate; }

  /* Écriture fluide + caret clignotant */
  #annexe::after { content:'|'; margin-left:.08em; animation:blink .7s steps(1,end) infinite; }
  @keyframes blink { 50% { opacity:0; } }
</style>

<!-- HERO -->
<section
  class="hero relative min-h-[92vh] grid place-items-center text-center bg-cover bg-center hero-zoom"
  style="background-image:url('{% static "img/hero-etudiants.jpg" %}');"
>
  <div class="absolute inset-0 bg-black/55 pointer-events-none z-0"></div>
  <div class="absolute inset-0 bg-gradient-to-b from-transparent via-black/10 to-black/30 pointer-events-none z-0"></div>

  <div class="relative z-10 max-w-5xl mx-auto px-4">
    <div class="flex flex-col items-center gap-6">
      <img src="{% static 'img/logo-transparent.png' %}" alt="ESFé"
           class="h-16 w-auto drop-shadow-[0_6px_30px_rgba(255,255,255,.35)]">

      <h1 class="font-display text-white tracking-tight text-5xl sm:text-6xl lg:text-7xl leading-[1.05]">
        ESFé — <span id="annexe" class="text-brand-cyan">Mali</span>
      </h1>

      <p class="text-white/90 text-lg sm:text-xl leading-relaxed max-w-2xl">
        Création d’excellence en sciences de la santé — <span class="opacity-95">Enseignement, pratique et insertion.</span>
      </p>

      <div class="mt-2 flex flex-col sm:flex-row items-center justify-center gap-4">
        <a href="#section-suivante"
           class="px-5 py-3 rounded-full border border-white/80 text-white hover:bg-white hover:text-black transition">↓</a>
        <a href="{{ apply_url|default:'#admission' }}"
           class="px-7 py-3 rounded-full bg-brand-cyan text-primary-900 font-medium hover:bg-white transition">
          S’inscrire
        </a>
      </div>
    </div>
  </div>
</section>

<!-- FORMATIONS PHARES -->
<section id="section-suivante" class="bg-white text-slate-900">
  <div class="max-w-container mx-auto px-4 py-14 sm:py-20">
    <h2 class="font-display tracking-tight text-2xl sm:text-3xl text-primary-900">Nos formations</h2>
    <div class="mt-3 h-0.5 w-20 bg-brand-cyan"></div>

    <div id="formations" class="mt-10 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
      {% for program in featured_programs %}
        <article class="group rounded-2xl bg-white border border-slate-200 shadow-soft overflow-hidden hover:shadow-lg transition-shadow flex flex-col">
          {% if program.image %}
            <img src="{{ program.image.url }}" alt="{{ program.title }}" class="h-48 w-full object-cover group-hover:scale-105 transition-transform duration-500">
          {% else %}
            <img src="https://picsum.photos/seed/{{ program.slug }}-med/800/400" alt="{{ program.title }}" class="h-48 w-full object-cover opacity-95 group-hover:scale-105 transition-transform duration-500">
          {% endif %}
          <div class="flex-1 p-5 flex flex-col">
            <h3 class="text-lg font-semibold text-slate-900">{{ program.title }}</h3>
            <p class="mt-2 text-slate-600 text-sm flex-1">
              Durée : {{ program.duration }}{% if program.diploma %} · Diplôme : {{ program.diploma }}{% endif %}
            </p>
            <div class="mt-4">
              <a href="{{ program.get_absolute_url }}" class="inline-flex items-center justify-center w-full px-4 py-2 text-sm font-medium rounded-xl bg-brand-cyan text-primary-900 hover:bg-primary-900 hover:text-white transition">
                Voir plus
              </a>
            </div>
          </div>
        </article>
      {% empty %}
        <p class="col-span-full text-slate-500">Aucune formation mise en avant pour le moment.</p>
      {% endfor %}
    </div>
  </div>
</section>

{# PARTIALS — Présentation courte ESFé #}
{% include "core/partials/_about_short.html" %}

{# PARTIALS — Chiffres clés #}
{% include "core/partials/_stats.html" %}

{# PARTIALS — Bandeau Admission / CTA #}
{% include "core/partials/_admissions_cta.html" %}

{# PARTIALS — Derniers articles du blog #}
{% include "core/partials/_blog_latest.html" %}

{# PARTIALS — Campus / Annexes #}
{% include "core/partials/_campuses.html" %}

<script>
  // Effet d’écriture fluide
  const annexes = ["Djélibougou","Moribabougou","Sikasso 1","Sikasso 2","San","Mopti","Ségou"];
  const el = document.getElementById('annexe');
  let i=0, j=0, del=false;
  const pause=1100, speedWrite=55, speedDel=36;

  (function loop(){
    const w = annexes[i];
    if(!del){
      el.textContent = w.slice(0, ++j);
      if(j === w.length){ del = true; return setTimeout(loop, pause); }
      return setTimeout(loop, speedWrite);
    } else {
      el.textContent = w.slice(0, --j);
      if(j === 0){ del = false; i = (i+1) % annexes.length; }
      return setTimeout(loop, speedDel);
    }
  })();

  // Scroll doux vers la section suivante
  document.addEventListener('click', e => {
    const btn = e.target.closest('a[href="#section-suivante"]');
    if (!btn) return;
    e.preventDefault();
    document.querySelector('#section-suivante').scrollIntoView({behavior:'smooth'});
  });
</script>

{% endblock %}
