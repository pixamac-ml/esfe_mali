<div class="rounded-2xl border p-4 bg-white">
  <div class="flex items-center justify-between">
    <div class="font-medium">
      {% if c.display_name %}
        {{ c.display_name }}
      {% elif c.user %}
        {{ c.user.username }}
      {% else %}
        Anonyme
      {% endif %}
      {% if c.is_staff_note %}
        <span class="ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700">Réponse ESFé</span>
      {% endif %}
    </div>
    <div class="text-xs text-slate-500">{{ c.created_at|date:"d M Y H:i" }}</div>
  </div>

  <p class="mt-2 text-slate-700 whitespace-pre-line">{{ c.message }}</p>

  <!-- Liste des réponses -->
  <div id="replies-{{ c.id }}" class="mt-3 pl-4 border-l space-y-3">
    {% for r in c.replies.all %}
      {% if r.is_approved %}
        {% include "blog/partials/reply_item.html" with r=r %}
      {% endif %}
    {% endfor %}
  </div>

  <!-- Formulaire de réponse -->
  <form data-reply="1" method="post" action="{% url 'blog:comment_reply' c.post.slug c.id %}" class="mt-3">
    {% csrf_token %}
    {% if not request.user.is_authenticated %}
      <input type="text" name="display_name" placeholder="Votre nom" class="border rounded-xl px-3 py-2 mb-2 w-full">
    {% endif %}
    <textarea name="message" rows="2" placeholder="Répondre…" class="border rounded-xl px-3 py-2 w-full"></textarea>
    <button class="mt-2 px-3 py-1.5 rounded-lg border">Répondre</button>
  </form>
</div>
