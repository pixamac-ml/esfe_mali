{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block title %}{{ program.title }} — {{ SITE_NAME }}{% endblock %}

{% block content %}

<!-- HERO -->
<section class="relative overflow-hidden">
  <div class="absolute inset-0">
    {% if program.image %}
      <img src="{{ program.image.url }}" alt="{{ program.title }}" class="w-full h-full object-cover">
    {% else %}
      <!-- ✅ Image par défaut depuis static -->
      <img src="{% static 'programs/img.jpg' %}" alt="Formation ESFé" class="w-full h-full object-cover">
    {% endif %}
    <!-- ✅ Overlay renforcé -->
    <div class="absolute inset-0 bg-slate-900/80"></div>
  </div>

  <div class="relative max-w-7xl mx-auto px-4 lg:px-6 py-20 grid lg:grid-cols-12 gap-10 text-white">
    <div class="lg:col-span-7">
      <div class="text-sm text-brand-cyan uppercase font-semibold tracking-wide mb-3">
        {{ program.get_cycle_display }}
      </div>
      <h1 class="text-4xl sm:text-5xl font-extrabold leading-tight text-white drop-shadow">
        {{ program.title }}
      </h1>
      {% if program.short_description %}
        <p class="mt-4 text-white/90 max-w-2xl leading-relaxed">
          {{ program.short_description }}
        </p>
      {% endif %}

      <div class="mt-8 grid grid-cols-2 sm:grid-cols-3 gap-4">
        <div class="bg-white/10 rounded-xl p-4 text-center">
          <span class="block text-xs text-white/70">Durée</span>
          <span class="font-semibold">{{ program.duration }}</span>
        </div>
        <div class="bg-white/10 rounded-xl p-4 text-center">
          <span class="block text-xs text-white/70">Niveau requis</span>
          <span class="font-semibold">{{ program.entry_requirement }}</span>
        </div>
        {% if program.diploma %}
        <div class="bg-white/10 rounded-xl p-4 text-center">
          <span class="block text-xs text-white/70">Diplôme obtenu</span>
          <span class="font-semibold">{{ program.diploma }}</span>
        </div>
        {% endif %}
      </div>

      <div class="mt-8">
        <a href="#admission"
           class="inline-flex items-center gap-2 rounded-xl bg-brand-cyan text-white hover:bg-white hover:text-primary-900 transition px-6 py-3 font-semibold shadow-lg">
          S’inscrire à cette formation
          <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path d="M12.293 3.293a1 1 0 0 1 1.414 0l4 4a1 1 0 1 1-1.414 1.414L14 6.414V17a1 1 0 1 1-2 0V6.414l-2.293 2.293A1 1 0 0 1 8.293 7.293l4-4Z"/></svg>
        </a>
      </div>
    </div>

    <!-- ✅ Encadré clair pour contraste -->
    <div class="lg:col-span-5">
      <div class="bg-white rounded-2xl p-6 shadow-lg">
        <h3 class="text-lg font-semibold mb-3 text-primary-900">Points forts</h3>
        <ul class="space-y-2 text-slate-700">
          <li class="flex items-start gap-2">
            <span class="text-brand-cyan">✔</span> Encadrement par des professionnels de santé
          </li>
          <li class="flex items-start gap-2">
            <span class="text-brand-cyan">✔</span> Pédagogie axée sur la pratique
          </li>
          <li class="flex items-start gap-2">
            <span class="text-brand-cyan">✔</span> Opportunités d’insertion et de stage
          </li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- DESCRIPTION -->
<section class="bg-white">
  <div class="max-w-5xl mx-auto px-4 lg:px-6 py-14">
    <h2 class="text-2xl font-bold text-primary-900 mb-5">À propos de la formation</h2>
    <div class="prose max-w-none text-slate-700 leading-relaxed">
      {{ program.description|safe }}
    </div>
  </div>
</section>

<!-- FRAIS -->
{% if program.inscription_fee or program.tuition_total %}
<section class="bg-slate-50">
  <div class="max-w-6xl mx-auto px-4 lg:px-6 py-14">
    <h2 class="text-2xl font-bold text-primary-900 mb-8 text-center">Frais & modalités de paiement</h2>
    <div class="grid md:grid-cols-3 gap-6">
      <div class="bg-white rounded-2xl shadow-sm border p-6">
        <h3 class="text-slate-600 mb-1 font-medium">Frais d’inscription</h3>
        <p class="text-2xl font-bold text-brand-cyan">{{ program.inscription_fee|default:"—" }} F CFA</p>
      </div>

      <div class="bg-white rounded-2xl shadow-sm border p-6">
        <h3 class="text-slate-600 mb-1 font-medium">Scolarité totale</h3>
        <p class="text-2xl font-bold text-brand-cyan">{{ program.tuition_total|default:"—" }} F CFA</p>
        {% if program.tranche_count and program.tranche_amount %}
        <p class="text-sm text-slate-500 mt-1">
          En {{ program.tranche_count }} tranches de {{ program.tranche_amount }} F CFA
        </p>
        {% endif %}
      </div>

      <div class="bg-white rounded-2xl shadow-sm border p-6">
        <h3 class="text-slate-600 mb-1 font-medium">Facilités</h3>
        <p class="text-slate-600">Paiements échelonnés, réductions anticipées, bourses partielles.</p>
      </div>
    </div>
  </div>
</section>
{% endif %}

<!-- DÉBOUCHÉS -->
<section class="bg-white">
  <div class="max-w-6xl mx-auto px-4 lg:px-6 py-14">
    <h2 class="text-2xl font-bold text-primary-900 mb-8 text-center">Débouchés professionnels</h2>
    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for opp in opportunities %}
      <article class="bg-slate-50 rounded-2xl border shadow-sm hover:shadow-md transition p-6 text-center">
        <div class="mx-auto h-14 w-14 rounded-full bg-primary-50 text-primary-900 flex items-center justify-center mb-4">
          <!-- briefcase-medical icon -->
          <svg class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor"><path d="M9 7V5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2M3 10h18v8a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-8Z"/><path d="M12 12v6M9 15h6"/></svg>
        </div>
        <h3 class="font-semibold text-slate-900">{{ opp.title }}</h3>
      </article>
      {% endfor %}
    </div>
  </div>
</section>

<!-- FORMULAIRE -->
<section id="admission" class="bg-slate-50">
  <div class="max-w-6xl mx-auto px-4 lg:px-6 py-14">
    <h2 class="text-2xl font-bold text-primary-900 mb-6 text-center">Postuler à cette formation</h2>
    {% include "programs/_admission_form.html" %}
  </div>
</section>

{% endblock %}
